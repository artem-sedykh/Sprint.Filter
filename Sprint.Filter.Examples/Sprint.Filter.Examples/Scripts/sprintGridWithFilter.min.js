var notificationLifeTime=5e3;$.ajaxSetup({cache:!1}),$(document).ajaxError(function(n,t,i,r){if(t.status>0)try{var u=$.parseJSON(t.responseText),f=function(){u.ErrorMessage&&$.fn.notification({lifeTime:notificationLifeTime,text:u.ErrorMessage,type:"failure"}),u.InnerException&&(u=u.InnerException,f())};f();return}catch(e){$.fn.notification({lifeTime:notificationLifeTime,text:r,type:"failure"})}}),$(document).ready(function(){$(".sprint-grid").sprintgrid()}),window.initAjaxControl=function(n){var t=$(n);$("ul.columnorder",t).sortable({helper:"clone",cursor:"move",axis:"y",start:function(n,t){t.helper.addClass("dragging")}}).disableSelection()};$("body").on("keypress","input.search",function(n){var u=n.keyCode||n.which,i,r,t;u===13&&(i=$(this),r=i.attr("data-update-grid"),r&&(t=$("body").data(r),t&&(t.gridOptions.SearchString=i.val(),t.refresh())))});$("body").on("mouseenter focus","a[data-grid-save]",function(){var n=$(this),t,i;n.data("initialized")||(t=n.attr("data-grid-save"),i={show:function(i){var f=n.data("modalbox"),r=$("form",i),u;window.initAjaxControl&&window.initAjaxControl(r),r.length&&($.validator.unobtrusive.parseDynamicContent(r[0]),u={beforeSerialize:function(){var n=r.find("#ActionGridRawOptions"),i=$("body").data(t);n.val(JSON.stringify(i.gridOptions))},beforeSubmit:function(){if(!r.valid())return!1;var n=r.find(":submit");n.attr("disabled","disabled")},error:function(n){var i=r.find(":submit"),t;i.removeAttr("disabled"),n.status===400&&(t=$.parseJSON(n.responseText),r.data("validator").showErrors(t))},success:function(n){var i=$('div[data-filter-list="'+t+'"]');$.get(i.attr("data-action"),{stateId:n},function(n){i.html(n),f.client_hide("hide")})}},r.ajaxForm(u))}},n.modalbox(i),n.data("initialized",!0))});$("body").on("change",".grid-state-list",function(){var n=$(this),t=n.parents("form:first").find("#Name");n.val()?t.val(n.find(":selected").text()):t.val("")});$("body").on("click","a[data-load-grid-state]",function(){var n=$(this);return $.ajax({dataType:"json",url:n.attr("href"),success:function(t){var i=n.attr("data-load-grid-state"),u=$('input.search[data-update-grid="'+i+'"]'),r;u.val(t.SearchString),i&&(r=$("body").data(i),r&&(r.refresh(t),n.closest("ul.saved-filters").find("a.selected").removeClass("selected"),n.addClass("selected")))}}),!1});$("body").on("click","a[data-clear-state]",function(){var n=$(this);return $.ajax({dataType:"json",url:n.attr("href"),success:function(t){var i=n.attr("data-clear-state"),u=$('input.search[data-update-grid="'+i+'"]'),r;u.val(t.SearchString),i&&(r=$("body").data(i),r&&(r.refresh(t),$('div[data-filter-list="'+i+'"]').find("a.selected").removeClass("selected")))}}),!1});$("body").on("mouseenter focus","a[data-grid-setting]",function(){var n=$(this),t,i;n.data("initialized")||(t=n.attr("data-grid-setting"),i={show:function(i){var u=n.data("modalbox"),r=$("form",i);window.initAjaxControl&&window.initAjaxControl(r),r.length&&($.validator.unobtrusive.parseDynamicContent(r[0]),r.submit(function(){if(!r.valid())return!1;var i=$("body").data(t),n=i.gridOptions;return n.PageOpt=n.PageOpt||{},n.PageOpt.ps=$("#PageSize").val(),$("ul.columnorder li").each(function(t,i){var u=$(i).find(":checkbox"),r,f;u.length&&(r=u.attr("id"),f=u.is(":checked"),n.ColOpt=n.ColOpt||{},n.ColOpt[r]=n.ColOpt[r]||{},n.ColOpt[r].co=t,n.ColOpt[r].vc=f)}),i.refresh(null,null,function(){u.client_hide("hide")}),!1}))},ajaxSettings:{type:"POST",contentType:"application/json",data:function(){var n=$("body").data(t);return JSON.stringify(n.gridOptions)},dataType:"html"}},n.modalbox(i))});$("body").on("mouseenter focus","a[data-filter]",function(){var n=$(this),t,i;n.data("initialized")||(t=n.attr("data-filter"),i={show:function(i){var u=n.data("modalbox"),r=$("form",i);window.initAjaxControl&&window.initAjaxControl(r),r.length&&($.validator.unobtrusive.parseDynamicContent(r[0]),r.submit(function(){var i,n,f;return r.valid()?(t&&(i=$("body").data(t),n=i.gridOptions,delete n.Filters,f=r.serializeArray(),$.each(f,function(){n[this.name]!==undefined?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),i.refresh(null,null,function(){u.client_hide("hide")})),!1):!1}))},ajaxSettings:{type:"POST",contentType:"application/json",data:function(){var n=$("body").data(t);return JSON.stringify(n.gridOptions)},dataType:"html"}},n.modalbox(i))});$("body").on("click","[data-filter-delete]",function(){var n=$(this);confirm("Are you sure you want to remove the selected entry?")&&$.post(n.attr("data-filter-delete"),function(){var t=n.closest("ul");n.closest("li").remove(),t.find("li").length||t.append('<li class="empty">Empty.<\/li>')})});(function(n){n.validator.unobtrusive.parseDynamicContent=function(t){n.validator.unobtrusive.parse(t);var r=n(t).first().closest("form"),i=r.data("unobtrusiveValidation"),u=r.validate();n.each(i.options.rules,function(t,r){if(u.settings.rules[t]==undefined){var f={};n.extend(f,r),f.messages=i.options.messages[t],n("[name='"+t+"']").rules("add",f)}else n.each(r,function(r,f){if(u.settings.rules[t][r]==undefined){var e={};e[r]=f,e.messages=i.options.messages[t][r],n("[name='"+t+"']").rules("add",e)}})})}})($);